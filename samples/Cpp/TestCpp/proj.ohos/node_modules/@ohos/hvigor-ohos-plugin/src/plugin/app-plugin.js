"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppPlugin=void 0;const hvigor_base_1=require("@ohos/hvigor-base"),project_task_service_js_1=require("../tasks/service/project-task-service.js"),assemble_app_js_1=require("../tasks/hook/assemble/assemble-app.js"),project_model_impl_js_1=require("../model/project/project-model-impl.js"),clean_js_1=require("../tasks/common/clean.js"),sync_project_js_1=require("../tasks/sync/sync-project.js"),legacy_project_model_impl_js_1=require("../model/project/legacy-project-model-impl.js"),task_names_js_1=require("../tasks/common/task-names.js");var SyncTask=task_names_js_1.TaskNames.SyncTask;const dependency_manager_js_1=require("../project/dependency/dependency-manager.js"),default_plugin_id_js_1=require("./common/default-plugin-id.js");class AppPlugin extends hvigor_base_1.HvigorPlugin{constructor(e,s){super(default_plugin_id_js_1.DefaultPluginId.OHOS_APP_PLUGIN),this._project=e,this._projectName=e.getName(),this._projectModel=s?legacy_project_model_impl_js_1.LegacyProjectModelImpl.getInstance(e):project_model_impl_js_1.ProjectModelImpl.getInstance(e);const t=new dependency_manager_js_1.DependencyManager(s,this._projectModel);this._taskService=new project_task_service_js_1.ProjectTaskService(e,this._projectModel,t.createModelDependencyInfo(),s),this._project.registry(new assemble_app_js_1.AssembleApp(this._project,this._taskService)),this._project.registry(new clean_js_1.Clean(this._project,this._taskService)),this._project.registry(new sync_project_js_1.SyncProject(this._project,SyncTask.syncTaskName(this._projectName))),AppPlugin.initTraceData()}static initTraceData(){hvigor_base_1.traceBuildAnalyze.taskTime.set("compileArkTS",0),hvigor_base_1.traceBuildAnalyze.taskTime.set("compileJS",0),hvigor_base_1.traceBuildAnalyze.taskTime.set("compileResource",0),hvigor_base_1.traceBuildAnalyze.taskTime.set("packageHap",0),hvigor_base_1.traceBuildAnalyze.taskTime.set("signHap",0)}getTaskService(){return this._taskService}}exports.AppPlugin=AppPlugin;