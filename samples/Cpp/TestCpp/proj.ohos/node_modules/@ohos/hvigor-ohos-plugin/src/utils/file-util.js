"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.FileUtil=void 0;const crypto_1=require("crypto"),ohos_logger_js_1=require("./log/ohos-logger.js"),fs_extra_1=__importDefault(require("fs-extra")),os_1=__importDefault(require("os")),path_1=__importDefault(require("path")),system_util_js_1=require("./system-util.js");class FileUtil{static isDirectory(...e){return fs_extra_1.default.statSync(path_1.default.resolve(...e)).isDirectory()}static checkDirWithoutDelete(...e){const t=path_1.default.resolve(...e);fs_extra_1.default.existsSync(t)||fs_extra_1.default.mkdirSync(t,{recursive:!0})}static checkFile(...e){const t=path_1.default.resolve(...e);fs_extra_1.default.existsSync(t)||FileUtil.makeFile(t),fs_extra_1.default.removeSync(t),FileUtil.makeFile(t)}static makeFile(e,t=""){fs_extra_1.default.writeFileSync(e,t)}static deleteFile(e){try{fs_extra_1.default.existsSync(e)&&fs_extra_1.default.removeSync(e)}catch(t){this._log._printErrorAndExit(`Please check and remove file ${os_1.default.EOL}at ${e}`)}}static readFile(e){try{if(!fs_extra_1.default.existsSync(e))return;return fs_extra_1.default.readFileSync(e,{encoding:"utf-8"})}catch(t){return void this._log.error(`Please check file at ${e}.`)}}static recursiveRmdirSync(e){fs_extra_1.default.existsSync(e)&&fs_extra_1.default.rmdirSync(e,{recursive:!0})}static checkPathLength(e){const t=(0,system_util_js_1.maxPathLength)(),r=`\t\t1. Make your project root path shorter.${os_1.default.EOL}`,s=`\t\t2. Simplify your project name.${os_1.default.EOL}`,a=`\t\t3. Simplify your module name.${os_1.default.EOL}`,i=`\t\t4. Configure a shorter target name.${os_1.default.EOL}`;e.length>t&&this._log._buildError(`The length of path exceeds the maximum length: ${t}.`)._solution(`Please try the following solutions:${os_1.default.EOL}${r}${s}${a}${i}`)._file(`'${e}'`)._printErrorAndExit()}static hashEntry(e,t){const r=(0,crypto_1.createHash)("MD5");return this.readDir(e,r,t),r.digest("hex")}static readDir(e,t,r){fs_extra_1.default.readdirSync(e,{withFileTypes:!0}).forEach((s=>{const a=path_1.default.join(e,s.name);if(r&&!r.test(a))return;fs_extra_1.default.statSync(a).isDirectory()?this.readDir(a,t,r):t.update(fs_extra_1.default.readFileSync(a))}))}static convertToAbsolutePath(e,t){return path_1.default.isAbsolute(e)?e:path_1.default.resolve(t,e)}}exports.FileUtil=FileUtil,FileUtil._log=ohos_logger_js_1.OhosLogger.getLogger("File");