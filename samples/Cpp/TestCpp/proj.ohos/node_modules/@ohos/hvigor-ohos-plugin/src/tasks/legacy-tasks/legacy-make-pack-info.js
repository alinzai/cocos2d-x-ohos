"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LegacyMakePackInfo=void 0;const ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),task_names_js_1=require("../common/task-names.js"),legacy_merge_profile_js_1=require("./legacy-merge-profile.js");var LegacyFATask=task_names_js_1.TaskNames.LegacyFATask;const abstract_make_pack_info_js_1=require("../abstract-make-pack-info.js"),file_set_js_1=require("@ohos/hvigor-base/src/internal/snapshot/util/file-set.js");class LegacyMakePackInfo extends abstract_make_pack_info_js_1.AbstractMakePackInfo{constructor(e){super(e,LegacyFATask.MAKE_PACK_INFO),this.log=ohos_logger_js_1.OhosLogger.getLogger(LegacyMakePackInfo.name)}declareInputFiles(){const e=this.targetService.getTargetData().getModuleSourceSetModel().getLegacyModuleTargetRes().getJsonPath();return(new file_set_js_1.FileSet).addEntry(e)}initTaskDepends(){this.module.registryDependsOnTask(this,new legacy_merge_profile_js_1.LegacyMergeProfile(this.targetService))}doTaskAction(e){const s=this.service.getModuleModel(),a=s.getJsonObjByTargetName(e.getTargetName()),t=this.service.getProjectModel(),o={bundleName:a.app.bundleName,version:a.app.version};this.doMakePackInfo(this.log,t,s,o,!0)}getModuleObj(e,s,a,t){const o=s.getJsonObjByTargetName(t);return{mainAbility:o.module.mainAbility,deviceType:e,abilities:this.processAbilities(o.module.abilities),distro:o.module.distro,apiVersion:null!=a?a:o.app.apiVersion}}getPackageObj(e,s,a){return{deviceType:e.getTargetDeviceType(),moduleType:s.module.distro.moduleType,deliveryWithInstall:s.module.distro.deliveryWithInstall,name:a}}}exports.LegacyMakePackInfo=LegacyMakePackInfo;