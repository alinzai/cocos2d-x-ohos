"use strict";var __importDefault=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.HosRemoteComponentLoader=void 0;const sdkmanager_common_1=require("@ohos/sdkmanager-common"),hos_component_constants_1=require("../const/hos-component-constants"),loader_util_1=require("./loader-util"),object_util_1=require("../util/object-util"),path_1=__importDefault(require("path")),hos_location_mapper_1=require("./hos-location-mapper"),abstract_hos_remote_component_loader_1=require("./abstract-hos-remote-component-loader"),hos_biz_util_1=require("../util/hos-biz-util");class HosRemoteComponentLoader extends abstract_hos_remote_component_loader_1.AbstractHosRemoteComponentLoader{constructor(o,t,e=new sdkmanager_common_1.SimpleProgress){super(o,t,e)}createReqParam(){return{osType:(0,hos_biz_util_1.convertOsType)(this.settings.getOsType()),supportVersion:hos_component_constants_1.SUPPORT_HARMONYOS_SDK_VERSION}}convertComponent(o){const t=super.convertComponent(o);return(0,loader_util_1.mapToolchainsApiVersion)(t),t.location=this.getLocation(t,this.settings.getLocation()),t}addComponent(o,t){super.addComponent(o,t),this._copyToolchains(o,t)}_copyToolchains(o,t){if(sdkmanager_common_1.ComponentPath.TOOLCHAINS===t.getPath()&&hos_component_constants_1.TOOLCHAINS_6_5_4_VERSION===t.getVersion()){const e=(0,object_util_1.copyHosComponentDto)(t);e.apiVersion=4,e.location=this.getLocation(e,this.settings.getLocation()),o.push(e);const n=(0,object_util_1.copyHosComponentDto)(t);n.apiVersion=5,n.location=this.getLocation(n,this.settings.getLocation()),o.push(n)}}getLocation(o,t){return path_1.default.resolve(t,hos_component_constants_1.HMSCORE,(0,hos_location_mapper_1.generatePath)(o))}}exports.HosRemoteComponentLoader=HosRemoteComponentLoader;