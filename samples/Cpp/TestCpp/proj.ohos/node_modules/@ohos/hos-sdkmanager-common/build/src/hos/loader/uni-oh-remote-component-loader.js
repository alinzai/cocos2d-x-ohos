"use strict";var __awaiter=this&&this.__awaiter||function(t,o,e,n){return new(e||(e=Promise))((function(s,r){function a(t){try{_(n.next(t))}catch(t){r(t)}}function i(t){try{_(n.throw(t))}catch(t){r(t)}}function _(t){var o;t.done?s(t.value):(o=t.value,o instanceof e?o:new e((function(t){t(o)}))).then(a,i)}_((n=n.apply(t,o||[])).next())}))},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.UniOhRemoteComponentLoader=void 0;const abstract_hos_remote_component_loader_1=require("./abstract-hos-remote-component-loader"),sdkmanager_common_1=require("@ohos/sdkmanager-common"),uni_oh_component_constants_1=require("../const/uni-oh-component-constants"),path_1=__importDefault(require("path")),hos_biz_util_1=require("../util/hos-biz-util");class UniOhRemoteComponentLoader extends abstract_hos_remote_component_loader_1.AbstractHosRemoteComponentLoader{constructor(t,o,e=new sdkmanager_common_1.SimpleProgress){super(t,o,e)}createReqParam(){return{osType:(0,hos_biz_util_1.convertOsType)(this.settings.getOsType()),supportVersion:uni_oh_component_constants_1.SUPPORT_UNI_OH_SDK_VERSION}}getLocation(t,o){return super.getLocation(t,path_1.default.resolve(o,uni_oh_component_constants_1.OPENHARMONY))}load(){const t=Object.create(null,{load:{get:()=>super.load}});return __awaiter(this,void 0,void 0,(function*(){const o=yield t.load.call(this),e=yield new sdkmanager_common_1.OhRemoteComponentLoader(this.settings,this.axiosInstance,this.progress).load(),n=[];return e.filter((t=>t.getApiVersion()===uni_oh_component_constants_1.GET_FROM_OHOS_SDK_API_VERSION)).forEach((t=>{if(t instanceof sdkmanager_common_1.OhComponentDto){const o=t;o.location=this.getLocation(o,this.settings.getLocation()),n.push(o)}})),o.concat(n)}))}}exports.UniOhRemoteComponentLoader=UniOhRemoteComponentLoader;