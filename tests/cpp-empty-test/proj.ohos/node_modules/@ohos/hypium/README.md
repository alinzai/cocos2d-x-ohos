<div style="text-align: center;font-size: xxx-large" >Hypium</div>
<div style="text-align: center">A unit test framework for OpenHarmonyOS application</div>

## Hypium是什么?
***
- Hypium是OpenHarmony上的测试框架，提供测试用例编写、执行、结果显示能力，用于OpenHarmony系统应用接口以及应用界面测试。
- Hypium结构化模型：hypium工程主要由List.test.js与TestCase.test.js组成。
```
rootProject                  // Hypium工程根目录
├── moduleA
│   ├── src
│      ├── main                   // 被测试应用目录
│      ├── ohosTest               // 测试用例目录
│         ├── js/ets
│            └── test
│               └── List.test.js      // 测试用例加载脚本，ets目录下为.ets后缀
│               └── TestCase.test.js  // 测试用例脚本，ets目录下为.ets后缀
└── moduleB
    ...
│               └── List.test.js      // 测试用例加载脚本，ets目录下为.ets后缀
│               └── TestCase.test.js  // 测试用例脚本，ets目录下为.ets后缀
```

## 安装使用
***
- 在DevEco Studio内使用Hypium
- 工程级package.json内配置:
```json
"dependencies": {
    "@ohos/hypium": "1.0.3"
}
```
注：
hypium服务于OpenHarmonyOS应用对外接口测试、系统对外接口测试（SDK中接口），完成HAP自动化测试。详细指导：
[Deveco Studio](https://developer.harmonyos.com/cn/develop/deveco-studio)

#### 通用语法

- 测试用例采用业内通用语法，describe代表一个测试套， it代表一条用例。

| No.  | API        | 功能说明                                                     |
| ---- | ---------- | ------------------------------------------------------------ |
| 1    | describe   | 定义一个测试套，支持两个参数：测试套名称和测试套函数         |
| 2    | beforeAll  | 在测试套内定义一个预置条件，在所有测试用例开始前执行且仅执行一次，支持一个参数：预置动作函数 |
| 3    | beforeEach | 在测试套内定义一个单元预置条件，在每条测试用例开始前执行，执行次数与it定义的测试用例数一致，支持一个参数：预置动作函数 |
| 4    | afterEach  | 在测试套内定义一个单元清理条件，在每条测试用例结束后执行，执行次数与it定义的测试用例数一致，支持一个参数：清理动作函数 |
| 5    | afterAll   | 在测试套内定义一个清理条件，在所有测试用例结束后执行且仅执行一次，支持一个参数：清理动作函数 |
| 6    | it         | 定义一条测试用例，支持三个参数：用例名称，过滤参数和用例函数 |
| 7    | expect     | 支持bool类型判断等多种断言方法                               |

#### 断言库

- 示例代码：

```javascript
  expect(${actualvalue}).assertX(${expectvalue})
```

- 断言功能列表：


| No.  | API              | 功能说明                                                     |
| :--- | :--------------- | ------------------------------------------------------------ |
| 1    | assertClose      | 检验actualvalue和expectvalue(0)的接近程度是否是expectValue(1) |
| 2    | assertContain    | 检验actualvalue中是否包含expectvalue                         |
| 3    | assertEqual      | 检验actualvalue是否等于expectvalue[0]                        |
| 4    | assertFail       | 抛出一个错误                                                 |
| 5    | assertFalse      | 检验actualvalue是否是false                                   |
| 6    | assertTrue       | 检验actualvalue是否是true                                    |
| 7    | assertInstanceOf | 检验actualvalue是否是expectvalue类型                         |
| 8    | assertLarger     | 检验actualvalue是否大于expectvalue                           |
| 9    | assertLess       | 检验actualvalue是否小于expectvalue                           |
| 10   | assertNull       | 检验actualvalue是否是null                                    |
| 11   | assertThrowError | 检验actualvalue抛出Error内容是否是expectValue                |
| 12   | assertUndefined  | 检验actualvalue是否是undefined                               |

  示例代码：

```javascript
  import { describe, it, expect } from '@ohos/hypium';

  export default async function assertCloseTest() {
    describe('assertClose', function () {
      it('assertClose_success', 0, function () {
        let a = 100;
        let b = 0.1;
        expect(a).assertClose(99, b);
      })
    })
  }
```
#### 公共系统能力

| No.  | API                                                     | 功能描述                                                     |
| ---- | ------------------------------------------------------- | ------------------------------------------------------------ |
| 1    | existKeyword(keyword: string, timeout: number): boolean | hilog日志中查找指定字段是否存在，keyword是待查找关键字，timeout为设置的查找时间 |
| 2    | actionStart(tag: string): void                          | cmd窗口输出开始tag                                           |
| 3    | actionEnd(tag: string): void                            | cmd窗口输出结束tag                                           |

  示例代码：

```javascript
import { describe, it, expect, SysTestKit} from '@ohos/hypium';

export default function existKeywordTest() {
    describe('existKeywordTest', function () {
        it('existKeyword',DEFAULT, async function () {
            console.info("HelloTest");
            let isExist = await SysTestKit.existKeyword('HelloTest');
            console.info('isExist ------>' + isExist);
        })
    })
}
```
```javascript
import { describe, it, expect, SysTestKit} from '@ohos/hypium';

export default function actionTest() {
    describe('actionTest', function () {
        it('existKeyword',DEFAULT, async function () {
            let tag = '[MyTest]';
			SysTestKit.actionStart(tag);
            //do something
            SysTestKit.actionEnd(tag);
        })
    })
}
```



#### 专项能力

- 用例筛选能力：hypium支持根据用例属性筛选执行指定测试用例，使用方式是在测试应用的启动shell命令后新增" -s ${Key} ${Value}"。
- 测试套&用例随机执行（测试套与用例名称用“#”号连接，多个用“,”逗号分隔）
- dry run: 显示要执行的用例信息全集

| Key  | 含义说明                                                     | Value取值范围                                                |
| ---- | ------------------------------------------------------- | ------------------------------------------------------------ |
| level    | 用例级别      | "0","1","2","3","4", 例如：-s level 1 |
| size    | 用例粒度    | "small","medium","large", 例如：-s size small |
| testType    | 用例测试类型      | "function","performance","power","reliability","security","global","compatibility","user","standard","safety","resilience", 例如：-s testType function |
| class | 指定要执行的测试套&用例 | ${describeName}#${itName}，${describeName} , 例如：-s class attributeTest#testAttributeIt |
| notClass | 指定不执行的测试套&用例 | ${describeName}#${itName}，${describeName} , 例如：-s notClass attributeTest#testAttributeIt |
| random | 测试套&用例随机执行 | true,  例如：-s random true |
| dryRun | 显示要执行的用例信息全集 | true , 例如：-s dryRun true |

  示例代码

```javascript
import { describe, it, expect, TestType, Size, Level } from '@ohos/hypium';

export default function attributeTest() {
    describe('attributeTest', function () {
        it("testAttributeIt", TestType.FUNCTION | Size.SMALLTEST | Level.LEVEL0, function () {
            console.info('Hello Test');
        })
    })
}
```

#### Mock能力

##### 约束限制

单元测试框架Mock能力从npm包[1.0.1版本](https://repo.harmonyos.com/#/cn/application/atomService/@ohos%2Fhypium/v/1.0.1)开始支持


## 约束

***
    本模块首批接口从OpenHarmony SDK API version 8开始支持。

## Hypium开放能力隐私声明

-  我们如何收集和使用您的个人信息
	您在使用集成了Hypium开放能力的测试应用时，Hypium不会处理您的个人信息。
-  SDK处理的个人信息
	不涉及。
-  SDK集成第三方服务声明
	不涉及。
-  SDK数据安全保护
	不涉及。
-  SDK版本更新声明
	为了向您提供最新的服务，我们会不时更新Hypium版本。我们强烈建议开发者集成使用最新版本的Hypium。

