"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeTargetTaskName=exports.TargetTaskService=void 0;const sdkmanager_common_1=require("@ohos/sdkmanager-common"),common_const_js_1=require("../../const/common-const.js"),code_type_enum_js_1=require("../../enum/code-type-enum.js"),sdk_info_js_1=require("../../sdk/sdk-info.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),_log=ohos_logger_js_1.OhosLogger.getLogger("Hvigor-target-service");class TargetTaskService{constructor(e){this.targetData=e;const t=e.getModuleModel().getParentProject();this._sdkInfo=new sdk_info_js_1.SdkInfo(t.getCompileApiVersion(),this.getModuleRequiredSDKs(),!e.isHarmonyOS())}buildTaskName(e){return{...e,name:`${computeTargetTaskName(this.targetData.getTargetName(),e.name)}`}}getTargetData(){return this.targetData}getSdkInfo(){return this._sdkInfo}getModuleRequiredSDKs(){var e;const t=[sdkmanager_common_1.ComponentPath.TOOLCHAINS],o=this.targetData.getModuleModel();for(const r of o.getSourceSetByTargetName(common_const_js_1.DefaultTargetConst.DEFAULT_TARGET).getCodeMap().keys())code_type_enum_js_1.CodeType.CPP===r?(null===(e=o.getProfileOpt().buildOption)||void 0===e?void 0:e.externalNativeOptions)&&t.push(code_type_enum_js_1.CodeType.getSDKComponentName(r)):t.push(code_type_enum_js_1.CodeType.getSDKComponentName(r));const r=t.map((e=>e===sdkmanager_common_1.ComponentPath.ETS?"ArkTS":e.toLowerCase()));return _log.debug(`${o.getName()} require SDK: ${r.join(" ")}`),t}}function computeTargetTaskName(e,t){return`${e}@${t}`}exports.TargetTaskService=TargetTaskService,exports.computeTargetTaskName=computeTargetTaskName;