"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractMergeProfile=exports.INPUT_KEY=void 0;const ohos_hap_task_js_1=require("./task/ohos-hap-task.js"),lodash_1=require("lodash"),path_1=__importDefault(require("path")),build_directory_const_js_1=require("../const/build-directory-const.js"),inject_util_js_1=require("../utils/inject-util.js");exports.INPUT_KEY={isHarModule:"isHarModule",bundleName:"bundleName",targetSdkVersion:"targetSdkVersion",compatibleSdkVersion:"compatibleSdkVersion",multiProjects:"multiProjects",releaseType:"releaseType",buildRoot:"buildRoot",isDebug:"isDebug"};class AbstractMergeProfile extends ohos_hap_task_js_1.OhosHapTask{constructor(e,t){super(e,t),this._moduleTargetData=this.targetService.getTargetData(),this._projectModel=this.service.getProjectModel(),this._bundleName=this._moduleTargetData.getProduct().bundleName,this._targetSdkVersion=this._projectModel.getCompileApiVersion(),this._compatibleSdkVersion=this._projectModel.getCompatibleApiVersion(),this._releaseType=this.sdkInfo.getReleaseType(),this._targetName=this._moduleTargetData.getTargetName(),this._pathInfo=this._moduleTargetData.getPathInfo(),this._buildRoot=this._pathInfo.getBuildRoot()}mergeHarLibs(e){const t=this.service.getDependencyRootPaths(),s=this.service.getModuleDependencyPaths();return[...(0,lodash_1.difference)(t,s).map((t=>path_1.default.resolve(t,"src","main",e))),...s.map((t=>path_1.default.resolve(t,this._buildRoot,"default",build_directory_const_js_1.BuildDirConst.INTERMEDIATES,build_directory_const_js_1.BuildDirConst.INTERMEDIATES_MERGE_PROFILE,"default",e)))]}declareInputs(){const e=new Map;return this._bundleName&&e.set(exports.INPUT_KEY.bundleName,this._bundleName),e.set(exports.INPUT_KEY.targetSdkVersion,this._targetSdkVersion),e.set(exports.INPUT_KEY.compatibleSdkVersion,this._compatibleSdkVersion),e.set(exports.INPUT_KEY.releaseType,this._releaseType),e.set(exports.INPUT_KEY.buildRoot,this._buildRoot),e.set(exports.INPUT_KEY.isDebug,inject_util_js_1.InjectUtil.isDebug()),e}}exports.AbstractMergeProfile=AbstractMergeProfile;