"use strict";var __importDefault=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.GenerateNativeLibrary=void 0;const native_library_model_js_1=require("./native-library-model.js"),path_1=__importDefault(require("path"));class GenerateNativeLibrary{constructor(r,t,i,e,a){var s,l;this.library=new native_library_model_js_1.NativeLibraryModel,this.library.setAbi(i),this.library.setBuildCommandComponents(this.createBuildCommand(r,t)),this.library.setBuildType(a),this.library.setArtifactName(e.name),this.library.setFolders(this.findFolders(e)),this.library.setFiles(this.findFiles(e)),this.library.setOutputs(this.findOutputs(e)),this.library.setNameOnDisk(e.nameOnDisk),this.library.setRuntimeFiles(this.findRuntimeFiles(e)),this.library.setBuild(null===(s=e.paths)||void 0===s?void 0:s.build),this.library.setSource(null===(l=e.paths)||void 0===l?void 0:l.source)}getLibrary(){return this.library}createBuildCommand(r,t){return[path_1.default.resolve(r,"..","ninja.exe"),"-C",t]}findFolders(r){var t;const i=[];return null===(t=r.compileGroups)||void 0===t||t.forEach((r=>{var t;null===(t=r.includes)||void 0===t||t.forEach((r=>{r.path&&i.push(r.path)}))})),i}findFiles(r){var t;const i=[];return null===(t=r.sources)||void 0===t||t.forEach((r=>{r.path&&i.push(r.path)})),i}findOutputs(r){var t;const i=[];return null===(t=r.artifacts)||void 0===t||t.forEach((r=>{r.path&&i.push(r.path)})),i}findRuntimeFiles(r){var t,i;const e=[];return null===(i=null===(t=r.link)||void 0===t?void 0:t.commandFragments)||void 0===i||i.forEach((r=>{if("libraries"!==r.role)return;const t=r.fragment;t&&!t.startsWith("-")&&e.push(t)})),e}}exports.GenerateNativeLibrary=GenerateNativeLibrary;