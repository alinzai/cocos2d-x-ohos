"use strict";var __awaiter=this&&this.__awaiter||function(e,o,r,s){return new(r||(r=Promise))((function(i,t){function n(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(e){var o;e.done?i(e.value):(o=e.value,o instanceof r?o:new r((function(e){e(o)}))).then(n,a)}l((s=s.apply(e,o||[])).next())}))},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.run=exports.opts=exports.hvigorPath=void 0;const process_1=__importDefault(require("process")),exit_js_1=require("../util/exit.js"),make_title_js_1=require("../util/make-title.js"),init_env_config_props_js_1=require("../util/init-env-config-props.js"),hvigor_base_1=require("@ohos/hvigor-base"),hvigor_process_js_1=require("@ohos/hvigor-base/src/internal/lifecycle/hvigor-process.js"),global_data_js_1=require("@ohos/hvigor-base/src/internal/data/global-data.js"),cli_options_js_1=require("@ohos/hvigor-base/src/util/options/cli-options.js"),LiftOff=require("liftoff"),v8flags=require("v8flags"),yargs=require("yargs"),interpret=require("interpret"),{hideBin:hideBin}=require("yargs/helpers");exports.hvigorPath=require.resolve("@ohos/hvigor-base",{paths:[process_1.default.cwd()]});const cliVersion=require("../../package.json").version,localVersion=require(`${exports.hvigorPath}/../package.json`).version,_log=hvigor_base_1.HvigorLogger.getLogger("hvigor"),LOWEST_NODE_VERSION="v14.18.3",cli=new LiftOff({name:"hvigor",processTitle:(0,make_title_js_1.makeTitle)("hvigor",process_1.default.argv.slice(2)),moduleName:exports.hvigorPath,configName:"hvigorFile",v8flags:v8flags,extensions:interpret.jsVariants}),parser=yargs(hideBin(process_1.default.argv)).usage("Usage: hvigor [options]").alias("h","help").alias("v","version").example("hvigor assembleApp","Do assembleApp task").epilog("copyright 2022").command({command:"version",aliases:["v"],handler:()=>{_log.info("CLI version:",cliVersion),_log.info("Local version:",localVersion||"Unknown"),(0,exit_js_1.exit)(0)}}).options(cli_options_js_1.cliOptions);function run(){cli.prepare({cwd:exports.opts.cwd,require:exports.opts.require,completion:exports.opts.completion},(function(e){global_data_js_1.globalData.init(e,exports.opts),process_1.default.version<"v14.18.3"&&(_log.warn(`node version: ${process_1.default.version}`),_log.warn("The node version cannot be earlier than v14.18.3."),(0,exit_js_1.exit)(-1)),evaluateLogLevel(),(0,init_env_config_props_js_1.initEnvConfigProps)(),cli.execute(e,e.nodeFlags,(function(){return __awaiter(this,void 0,void 0,(function*(){hvigor_process_js_1.hvigorProcess.init();try{hvigor_process_js_1.hvigorProcess.start()}catch(e){e instanceof Error&&hvigor_process_js_1.hvigorProcess.error(e)}}))}))}))}function evaluateLogLevel(){exports.opts.debug?_log.setLevel(hvigor_base_1.levels.DEBUG):exports.opts.warn?_log.setLevel(hvigor_base_1.levels.WARN):exports.opts.error?_log.setLevel(hvigor_base_1.levels.ERROR):_log.setLevel(hvigor_base_1.levels.INFO)}exports.opts=parser.argv,exports.run=run;