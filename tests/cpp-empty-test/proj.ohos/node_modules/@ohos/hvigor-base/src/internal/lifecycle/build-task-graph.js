"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildTaskGraph=void 0;const hvigor_log_js_1=require("../../log/hvigor-log.js"),task_directed_acyclic_graph_js_1=require("../task/core/task-directed-acyclic-graph.js"),task_path_util_js_1=require("../task/util/task-path-util.js"),task_module_util_js_1=require("../task/util/task-module-util.js"),_log=hvigor_log_js_1.HvigorLogger.getLogger("hvigor-build-task-graph");function buildTaskGraph(e){function t(e,t){e.forEach((e=>{const a=e.getNode().getName(),s=e.getName(),o=e.getPath();for(const r of e.getDependsOn()){const e=(0,task_module_util_js_1.getModuleFromTaskPath)(r);if(void 0===e){const e=`Cannot find node '${r}' in '${a}:${s}'.`;_log.errorMessageExit(e)}const i=(0,task_path_util_js_1.getTaskNameFromTaskPath)(r);if(!e.getTaskContainer().hasTask(i)){const t=`'${s}' in ${a} lacks the dependency task '${i}' in ${e.getName()}.`;_log.errorMessageExit(t)}if(t.addEdge(o,r),!task_directed_acyclic_graph_js_1.projectTaskDag.addEdge(o,r)){const e=`Circular dependency between the following tasks: ${o} -> ${r}.`;_log.errorMessageExit(e)}}}))}e.getSubModules().forEach((e=>{t(e.getTaskContainer().getAllTasks(),e.getTaskGraph())})),t(e.getTaskContainer().getAllTasks(),e.getTaskGraph())}exports.buildTaskGraph=buildTaskGraph;