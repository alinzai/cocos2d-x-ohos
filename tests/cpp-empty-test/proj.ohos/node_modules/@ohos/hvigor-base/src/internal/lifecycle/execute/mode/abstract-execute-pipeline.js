"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractExecutePipeline=void 0;const trace_build_analyze_js_1=require("../../../../trace/trace-build-analyze.js"),task_executor_js_1=require("../../../core/task-executor.js"),hvigor_log_js_1=require("../../../../log/hvigor-log.js"),_log=hvigor_log_js_1.HvigorLogger.getLogger("hvigor-abstract-pipeline");class AbstractExecutePipeline{constructor(e,t){this.shouldCheckTask=!1,this.project=e,this.taskOptions=t;const s=this.taskOptions.toRunTasks;this.toRunTask=s.length?s:["default"]}startPipeline(){this.taskOptions.isNeedSync?this.executeSyncTask():(this.recordTraceData(),this.executeTask())}findAllNeedExecuteTasksForNodes(e){const t=[];return this.toRunTask.forEach((s=>{e.forEach((e=>{const a=e.getTaskByName(s);void 0!==a?t.push(a.getPath()):this.shouldCheckTask&&_log.errorMessageExit(`Task ${this.toRunTask} not found in hvigor node: ${e.getName()}.`)}))})),t}recordTraceData(){trace_build_analyze_js_1.traceBuildAnalyze.moduleNum=this.project.getAllSubModules().length}executeSyncTask(){task_executor_js_1.taskExecutorInst.executeTaskByName(this.findPipeAllNeedExecuteSyncTasks())}executeTask(){task_executor_js_1.taskExecutorInst.executeTaskByName(this.findPipeAllNeedExecuteTasks())}}exports.AbstractExecutePipeline=AbstractExecutePipeline;