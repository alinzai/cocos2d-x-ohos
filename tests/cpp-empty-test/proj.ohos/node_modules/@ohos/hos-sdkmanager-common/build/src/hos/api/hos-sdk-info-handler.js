"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HosSdkInfoHandler=void 0;const hos_local_component_loader_1=require("../loader/hos-local-component-loader"),sdkmanager_common_1=require("@ohos/sdkmanager-common"),hos_remote_component_loader_1=require("../loader/hos-remote-component-loader"),hos_license_manager_1=require("../license/hos-license-manager"),hos_task_factory_1=require("../task/hos-task-factory"),uni_oh_local_component_loader_1=require("../loader/uni-oh-local-component-loader");class HosSdkInfoHandler extends sdkmanager_common_1.CommonSdkInfoHandler{constructor(e,o=new sdkmanager_common_1.SimpleProgress){super(new sdkmanager_common_1.SdkInfoSettings(e)),this._progress=o,this._sdkInfoConfig=e}getOrDownload(e){const o=new hos_local_component_loader_1.HosLocalComponentLoader(this.sdkSettings.getLocation(),this._progress);return this.doGetOrDownload(e,this.mapComponents(o.load()),(e=>{const n=o.getInCompatibleComponents(),t=new uni_oh_local_component_loader_1.UniOhLocalComponentLoader(this.sdkSettings.getLocation(),this._progress);t.load();const s=t.getInCompatibleComponents();if(n.length>0||s.length>0)throw new sdkmanager_common_1.SdkException("HosSdkInfoHandler execution failed",new sdkmanager_common_1.ErrorTip("","The SDK management mode has changed.",`\n\t\tMethod 1: Update the SDKs by going to Tools > SDK Manager > SDKs > HarmonyOS and following the onscreen instructions. Open SDK Manager\n\t\tMethod 2: Uninstall the SDKs in the following paths:\n${n.map((e=>`\t\t    ${e.getLocation()}`)).join("\n")}\n${s.map((e=>`\t\t    ${e.getLocation()}`)).join("\n")}\n`))}))}getLocalComponents(){return new hos_local_component_loader_1.HosLocalComponentLoader(this.sdkSettings.getLocation()).load()}getProgress(){return this._progress}getRemoteComponents(){return new hos_remote_component_loader_1.HosRemoteComponentLoader(this.sdkSettings,this.sdkSettings.getNetClient(),this._progress).load()}findUnacceptedLicenses(e){const o=e.map((e=>e.getLicense()));return new hos_license_manager_1.HosLicenseManager(this.sdkSettings,this.sdkSettings.getNetClient()).findUnacceptedLicenses(o,this._progress)}getLicenseNotAcceptedMessage(e){const o=e.join(",");return new sdkmanager_common_1.ErrorTip("","The SDK license agreement is not accepted.",`Go to Tools > SDK Manager > SDKs > HarmonyOS, download the ${o} SDK, and accept the license agreement. Open SDK Manager`)}getNotFoundException(){return"1.Go to Tools > SDK Manager > SDKs > HarmonyOS, download the components, and sync the project. Open SDK Manager"}createInstallComponentTask(e){return(0,hos_task_factory_1.createHosInstallTask)(e,this.sdkSettings,this.sdkSettings.getNetClient())}_getLocalIncompatibleSdks(e){return e.getInCompatibleComponents().map((e=>e.getPath()))}}exports.HosSdkInfoHandler=HosSdkInfoHandler;